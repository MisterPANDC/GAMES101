- [00:00:05](https://www.bilibili.com/video/BV1X7411F744?p=7#t=5.27) 

![[GAMES101_Lecture_07-1.jpeg]]

![[GAMES101_Lecture_07-2.jpeg]]

![[GAMES101_Lecture_07-3.jpeg]]

![[GAMES101_Lecture_07-4.jpeg]]
为什么不能先采样后模糊
- [00:02:49](https://www.bilibili.com/video/BV1X7411F744?p=7#t=02:49.63) 
# Painter's Algorithm

![[GAMES101_Lecture_07-5.jpeg]]
从后往前画，然后覆盖
但是这个顺序的确定，其实不容易

具体有一个深度的排序。但也有可能有无法排序的情况，如图：
![[GAMES101_Lecture_07-6.jpeg]]

为了解决一下问题，提出来z-buffer

- [00:10:48](https://www.bilibili.com/video/BV1X7411F744?p=7#t=10:48.89) 
# Z-Buffer
![[GAMES101_Lecture_07-7.jpeg]]
同时生成两个图，对二维显示的每个像素，记录一个当前的最小z值（注意这里我们讨论的是正坐标系，越小的值约近）
然后另一个buffer存当前的颜色像素值，那么每次画新图形的时候，就先判断一下远近的关系，然后看是否覆盖颜色像素
- [00:14:25](https://www.bilibili.com/video/BV1X7411F744?p=7#t=14:25.71) 
![[GAMES101_Lecture_07-8.jpeg]]

- [00:17:16](https://www.bilibili.com/video/BV1X7411F744?p=7#t=17:16.64) 

![[GAMES101_Lecture_07-9.jpeg]]

![[GAMES101_Lecture_07-10.jpeg]]

- [00:23:54](https://www.bilibili.com/video/BV1X7411F744?p=7#t=23:54.15) 
理论上排序是nlogn，但是这里我们只找最近的，n就实现了
![[GAMES101_Lecture_07-11.jpeg]]
这就解决了之前画家算法的问题
# Shading
- [00:30:38](https://www.bilibili.com/video/BV1X7411F744?p=7#t=30:38.75) 
![[GAMES101_Lecture_07-13.jpeg]]

为什么要讨论着色
![[GAMES101_Lecture_07-14.jpeg]]
我们通过视图变换，投影然后光栅化

![[GAMES101_Lecture_07-15.jpeg]]

但我们差了一个着色的过程
![[GAMES101_Lecture_07-16.jpeg]]

具体来说，就是每个面的颜色有所不同
![[GAMES101_Lecture_07-17.jpeg]]

![[GAMES101_Lecture_07-18.jpeg]]
字面意思上就是引入明暗和颜色的不同
![[GAMES101_Lecture_07-19.jpeg]]

![[GAMES101_Lecture_07-20.jpeg]]

具体可以看这个例子
- [00:38:32](https://www.bilibili.com/video/BV1X7411F744?p=7#t=38:32.84) 
![[GAMES101_Lecture_07-21.jpeg]]
高光（直接）
漫反射
环境关照

考虑一个点上的光照，我们只考虑其局部，将其定义为一个面，有法线与观测方向，这些向量都是单位向量
![[GAMES101_Lecture_07-22.jpeg]]

注意着色只是物体表面的明暗处理，不涉及阴影（也是局部性）
shading和shadow不一样
![[GAMES101_Lecture_07-23.jpeg]]

我们先看漫反射
- [00:47:27](https://www.bilibili.com/video/BV1X7411F744?p=7#t=47:27.31) 
![[GAMES101_Lecture_07-24.jpeg]]

不同的角度，可能导致不同的明暗效果
![[GAMES101_Lecture_07-25.jpeg]]
这个夹角决定了明暗程度，这个定律就是==lambert's cosine law==
光照程度与面的法线与光照的夹角的余弦有关系

- [00:53:11](https://www.bilibili.com/video/BV1X7411F744?p=7#t=53:11.19) 
同时，还要考虑一个点光源辐射的问题
这个点光源不考虑衰减，那么从能量守恒的角度上来说，就是和这个球壳的表面积成反比，$s = \frac{1}{\pi} r^2$ 那么能量自然是$\frac{1}{r^2}I$
![[GAMES101_Lecture_07-26.jpeg]]

我们将上述讨论的东西结合在一起，就可以得出：
当前的能量和接受的能量。后面n l作为单位向量的点乘就表示了余弦，为什么要加一个max是因为负数没有意义
![[GAMES101_Lecture_07-27.jpeg]]
前面k表示一个系数，也就是物体材质吸收多少能量，这个k又与颜色有关
同时与观测角度无关，因为漫反射是均匀的
![[GAMES101_Lecture_07-28.jpeg]]


